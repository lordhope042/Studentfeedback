<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login â€“ HAFEDPOLY</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<style>
*{box-sizing:border-box;font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;}
body{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:16px;
      background:#007bff;position:relative;overflow:hidden;}
#networkCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;}
.box{width:100%;max-width:420px;background:#fff;border-radius:16px;padding:28px 22px;
     box-shadow:0 10px 35px rgba(0,0,0,.2);animation:fadeIn .6s ease;position:relative;z-index:1;}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
h1{margin:0 0 6px;color:#007bff;font-size:24px;text-align:center;}
p.sub{margin:0 0 18px;text-align:center;color:#555;font-size:14px;}
label{font-weight:600;color:#333;margin-top:12px;display:block;}
input{width:100%;padding:12px;border:1px solid #ccc;border-radius:10px;margin-top:6px;
      outline:none;transition:.25s;font-size:15px;}
input:focus{border-color:#007bff;box-shadow:0 0 0 4px rgba(0,123,255,.15);}
.pass-wrap{position:relative;}
.toggle{position:absolute;right:10px;top:50%;transform:translateY(-50%);
        font-size:13px;color:#007bff;cursor:pointer;user-select:none;}
button{width:100%;padding:13px;border:none;border-radius:10px;background:#007bff;
       color:#fff;font-weight:700;margin-top:18px;cursor:pointer;font-size:16px;transition:.25s;}
button:hover{background:#005ecb;}
.msg{margin-top:12px;text-align:center;font-weight:600;font-size:14px;}
.err{color:#d60000;}
.ok{color:#188038;}
.small{margin-top:14px;text-align:center;font-size:14px;}
.small a{color:#007bff;text-decoration:none;}
.small a:hover{text-decoration:underline;}
</style>
</head>
<body>
<canvas id="networkCanvas"></canvas>

<div class="box">
  <h1>HAFEDPOLY</h1>
  <p class="sub">Login to your portal</p>

  <form id="form">
    <label for="userId">Reg No or Email</label>
    <input id="userId" placeholder="e.g. NDCS/22/034 or ndcshope034@gmail.com" required />

    <label for="password">Password</label>
    <div class="pass-wrap">
      <input id="password" type="password" placeholder="Enter password" required />
      <span class="toggle" id="togglePass"><i class="fa-solid fa-eye"></i></span>
    </div>

    <button type="submit">Login</button>
  </form>

  <div id="msg" class="msg"></div>
  <div class="small">No account? <a href="register.html">Register</a></div>
</div>

<script>
const $ = id => document.getElementById(id);
const msg = $("msg");

// Password toggle
$("togglePass").onclick = () => {
  const f = $("password");
  f.type = f.type === "password" ? "text" : "password";
  $("togglePass").innerHTML = f.type === "password" ? '<i class="fa-solid fa-eye"></i>' : '<i class="fa-solid fa-eye-slash"></i>';
};

// Login logic
$("form").addEventListener("submit", e => {
  e.preventDefault();
  const userId = $("userId").value.trim();
  const password = $("password").value.trim();
  let users = JSON.parse(localStorage.getItem("users")||"[]");
  let user = users.find(u => 
    (u.email.toLowerCase() === userId.toLowerCase() || u.regno.toUpperCase() === userId.toUpperCase())
    && u.password === password
  );
  msg.textContent = "";
  if(!user){msg.textContent="Invalid credentials"; msg.className="msg err"; return;}
  msg.textContent = "Welcome "+user.name; msg.className="msg ok";

  // Set active session
  localStorage.removeItem("activeStudent");
  localStorage.removeItem("activeAdmin");
  if(user.role === "admin") localStorage.setItem("activeAdmin", JSON.stringify(user));
  else localStorage.setItem("activeStudent", JSON.stringify(user));

  setTimeout(() => location.href = user.role==="admin"?"admin-dashboard.html":"student-dashboard.html", 700);
});

// Default admin
let users = JSON.parse(localStorage.getItem("users")||"[]");
if(!users.some(u => u.role==="admin")){
  users.push({
    uniqueId:"HAF-ADMIN",
    name:"Admin",
    email:"admin@hafedpoly.edu.ng",
    regno:"ADMIN001",
    password:"admin123",
    role:"admin"
  });
  localStorage.setItem("users", JSON.stringify(users));
}

// Network particle background
const canvas = document.getElementById('networkCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let nodes = [];
const nodeCount = 100;
const maxDist = 120;
for(let i=0;i<nodeCount;i++){
  nodes.push({
    x:Math.random()*canvas.width,
    y:Math.random()*canvas.height,
    vx:(Math.random()-0.5)*0.7,
    vy:(Math.random()-0.5)*0.7,
    r:Math.random()*3+1
  });
}
function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  nodes.forEach(n=>{
    n.x+=n.vx; n.y+=n.vy;
    if(n.x<0||n.x>canvas.width) n.vx*=-1;
    if(n.y<0||n.y>canvas.height) n.vy*=-1;
    ctx.beginPath();
    ctx.arc(n.x,n.y,n.r,0,Math.PI*2);
    ctx.fillStyle="rgba(255,255,255,0.7)";
    ctx.fill();
  });
  for(let i=0;i<nodes.length;i++){
    for(let j=i+1;j<nodes.length;j++){
      const dx = nodes[i].x - nodes[j].x;
      const dy = nodes[i].y - nodes[j].y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      if(dist<maxDist){
        ctx.beginPath();
        ctx.moveTo(nodes[i].x,nodes[i].y);
        ctx.lineTo(nodes[j].x,nodes[j].y);
        ctx.strokeStyle=`rgba(255,255,255,${1-dist/maxDist})`;
        ctx.lineWidth=1;
        ctx.stroke();
      }
    }
  }
  requestAnimationFrame(animate);
}
animate();
window.addEventListener('resize',()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>
</body>
</html>